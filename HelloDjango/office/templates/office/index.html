{% extends 'office/base.html' %}


{% block content %}
<h1>Сайты</h1>
<br>

<h4>Всего: {{ sites|length|add:"2"}} </h4>
<br>
<div style="width: 130px;">
    <a class="status status-paid show-new">Только Новые</a>
</div>
<br>


    <table>
        <thead>
            <tr>
<!--                <th>Папка beget</th>-->
                <th>Сылка</th>
<!--                <th>Редактор</th>-->
<!--                <th>Log.txt</th>-->
                <th>Прокла</th>
<!--                <th>Checker</th>-->
                <th>Статус</th>
            </tr>
        </thead>
     {% for site in sites %}

            <tr>
<!--            <td>{{ site.site_name }}</td>-->
                <td class="first {{ site.status_sub }}">
                    <a href="{{ site.get_http_site }}" target="_blank">{{ site.site_name }}</a>
                    <div class="icon-block">

                        {% if site.is_new %}
                    <a class="status status-paid new-site">Новый</a>
                    {% endif %}

                        <a href="{{ site.get_https_site }}" target="_blank"><i class="fas fa-lock"></i></a>
                    <a href="{{ site.get_beget_editor }}" target="_blank"><i class="fas fa-user-edit"></i></a>
                   <a href="{{ site.get_log_url }}" target="_blank"> <i class="far fa-address-book"></i></a>
                        </div>
                </td>
<!--                <td><a href="{{ site.get_beget_editor }}" target="_blank">edit</a></td>-->
<!--                <td><a href="{{ site.get_log_url }}" target="_blank">log.txt</a></td>-->
                <td>{{ site.title|slice:":30" }}</td>
<!--                <td><a href="{% url 'office:checker' site.id %}">Проверить</a></td>-->
                <td>
                    <p class="status {{ site.get_status_html }}">
                        <a href="{% url 'office:checker' site.id %}" class="status {{ site.get_status_html }}">{{ site.check_status }}</a>
                    </p>
                </td>

            </tr>
        {% endfor %}
    </table>

    <script>
        // Кнопка показать/скрыть не новые сайты
        var butn = $('.show-new')
        var newSiteTo = 'hide'
        $('a.show-new').click(function(){
            var rows = $('tr').slice(1)
            var rowsSiteNew = rows.filter(function(){
                var x = $(this).find($('a.new-site'))
                if (x.length == 0){return false}
                if (x.length != 0){return true}
            })
            if (newSiteTo == 'hide'){
                rows.hide()
                rowsSiteNew.show()
                newSiteTo = 'show'
                butn.text('Все')
                }
            else {
                rows.show()
                newSiteTo = 'hide'
                butn.text('Только Новые')
                }
        })
    </script>

{% endblock %}